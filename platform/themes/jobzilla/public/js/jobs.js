(()=>{function t(n){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(n)}function n(t,n){for(var a=0;a<n.length;a++){var o=n[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,e(o.key),o)}}function a(t,n,a){return(n=e(n))in t?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a,t}function e(n){var a=function(n,a){if("object"!=t(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var o=e.call(n,a||"default");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(n)}(n,"string");return"symbol"==t(a)?a:a+""}var o=function(){return t=function t(){var n=this;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),a(this,"searchParams",new URLSearchParams(window.location.search)),a(this,"$container",$(".jobs-container")),a(this,"$jobsList",this.$container.find(".jobs-listing")),a(this,"$loading",this.$container.find(".overlay")),a(this,"layout",this.searchParams.get("layout")||"list"),a(this,"$map",this.$container.find("#map")),"map"===this.layout?this.initMap():this.$map.hide(),this.handleFiltersOnChange(),this.$container.on("click",".side-bar-filter .backdrop",function(t){t.preventDefault(),$(this).parent().removeClass("active")}).on("click",".btn-open-filter",function(){n.$container.find(".side-bar-filter").addClass("active")}).on("click",".btn-close-filter",function(){n.$container.find(".side-bar-filter").removeClass("active")})},e=[{key:"submit",value:function(){var t=this,n=this.$container.find("#jobs-filter-form"),a=this.searchParams.toString(),e=n.get(0),o=e.method,i=e.action,r=n.data("ajax-url"),c=a?"".concat(r,"?").concat(a):r;window.history.pushState({},"","".concat(i,"?").concat(a)),a||window.history.pushState({},"",i),$.ajax({method:o,url:c,beforeSend:function(){t.$loading.show(),t.scrollToTop()},success:function(n){var a=n.data,e=n.message;t.$jobsList.html(a),t.$container.find(".woocommerce-result-count-left").text(e)},complete:function(){t.$loading.hide()}})}},{key:"handleFiltersOnChange",value:function(){var t=this;this.$container.on("change",function(n){t.updateSearchParams(n),t.submit(),"map"===t.searchParams.get("layout")?t.initMap():t.$map.hide()}),this.$container.on("click",".pagination li a",function(n){n.preventDefault();var a=new URL(n.target.href);t.searchParams.set("page",a.searchParams.get("page")),t.submit()})}},{key:"updateSearchParams",value:function(t){var n=this,a=t.target,e=a.name,o=a.value;e.includes("[]")?(this.searchParams.delete(e),$.each($('input[name="'.concat(e,'"]')),function(t,a){$(a).prop("checked")&&n.searchParams.append(e,$(a).val())})):this.searchParams.set(e,o)}},{key:"scrollToTop",value:function(){$("html, body").animate({scrollTop:this.$container.offset().top-130},0)}},{key:"initMap",value:function(){if(this.$map.length){this.$map.show(),window.currentMap&&(window.currentMap.off(),window.currentMap.remove());var t=L.map("map",{zoomControl:!0,scrollWheelZoom:!0,dragging:!0}).setView(this.$map.data("center"),13),n=$("html").prop("lang")||"en";L.tileLayer("https://mt0.google.com/vt/lyrs=m&hl=".concat(n,"&x={x}&y={y}&z={z}"),{maxZoom:19}).addTo(t);var a=L.markerClusterGroup(),e=[];this.$container.find(".job-board-street-map").map(function(n,o){var i=$(o),r=i.data("job");if(r&&r.latitude&&r.longitude){var c=L.divIcon({iconSize:L.point(50,20),html:i.data("map-icon")}),s=L.marker([r.latitude,r.longitude],{icon:c}).bindPopup('\n                    <div class="job-map-item">\n                        <img src="'.concat(i.data("company-logo"),'" alt="').concat(r.company.name,'">\n                        <div>\n                            <h4>').concat(r.company.name,'</h4>\n                            <a href="').concat(i.data("url"),'">\n                                <h5>').concat(r.name,"</h5>\n                            </a>\n                            <span>").concat(i.data("full-address"),"</span>\n                        </div>\n                    </div>\n                "));e.push(s),a.addLayer(s),t.flyToBounds(L.latLngBounds(e.map(function(t){return t.getLatLng()})))}}),t.addLayer(a),window.currentMap=t}}}],e&&n(t.prototype,e),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,o}();$(function(){return new o})})();